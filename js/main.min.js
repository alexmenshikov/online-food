
"use strict";document.addEventListener("DOMContentLoaded",()=>{const auth=()=>{const body=document.querySelector("body");const loginBtn=document.querySelector(".login");const logoutBtn=document.querySelector(".logout");const cartBtn=document.querySelector(".cart");const userName=document.querySelector(".user-name");const modalAuth=document.querySelector(".modal");const close=document.querySelector(".modal__content-close");const inputLogin=document.getElementById("login");const inputPassword=document.getElementById("password");const loginForm=document.getElementById("login-form");loginBtn.addEventListener('click',()=>{body.classList.add("block");modalAuth.style.display="flex";})
close.addEventListener('click',()=>{body.classList.remove("block");modalAuth.style.display="none";})
const validation=(user,login,password)=>{let flagLogin=false;let flagPassword=false;if(user.login){login.classList.remove("error");flagLogin=true;}else{login.classList.add("error");flagLogin=false;}
if(user.password){password.classList.remove("error");flagPassword=true;}else{password.classList.add("error");flagPassword=false;}
return(flagLogin&&flagPassword);};const login=(user)=>{loginBtn.style.display="none";logoutBtn.style.display="flex";cartBtn.style.display="flex";userName.style.display="flex";userName.textContent=user.login;modalAuth.style.display="none";body.classList.remove("block");}
const logout=()=>{loginBtn.style.display="flex";logoutBtn.style.display="none";cartBtn.style.display="none";userName.style.display="none";userName.textContent="";localStorage.removeItem("user");}
logoutBtn.addEventListener('click',()=>{logout();})
loginForm.addEventListener('submit',(event)=>{event.preventDefault();const user={login:inputLogin.value.trim(),password:inputPassword.value,};let flag=validation(user,inputLogin,inputPassword);if(flag){localStorage.setItem("user",JSON.stringify(user));login(user);}});if(localStorage.getItem("user")){login(JSON.parse(localStorage.getItem("user")));}};auth();const restaurants=()=>{const restaurantsItems=document.querySelector(".restaurants__items");const modalAuth=document.querySelector(".modal");const renderItems=(data)=>{data.forEach((item)=>{const{image,kitchen,name,price,products,stars,time_of_delivery}=item;const a=document.createElement("a");a.setAttribute("href","/online-food/restaurant.html");a.classList.add("restaurants__card");a.dataset.product=products;a.innerHTML=`
                <div class="restaurants__card-img">
                    <img src="${image}" alt="${name}">
                </div>
                <div class="restaurants__text">
                    <div class="restaurants__card-heading">
                        <div class="restaurants__card-title">${name}</div>
                        <div class="restaurants__card-time">${time_of_delivery} мин</div>
                    </div>
                    <div class="restaurants__card-info">
                        <div class="restaurants__card-rating">${stars}</div>
                        <div class="restaurants__card-price">От ${price} &#8381;</div>
                        <div class="restaurants__card-category">${kitchen}</div>
                    </div>
                </div>
            `;a.addEventListener('click',(event)=>{event.preventDefault();if(localStorage.getItem('user')){localStorage.setItem(("restaurant"),JSON.stringify(item));window.location.href="../online-food/restaurant.html";}else{modalAuth.style.display="flex";}})
restaurantsItems.append(a);})};fetch("../online-food/db/restaurants.json").then((response)=>response.json()).then((data)=>{renderItems(data);}).catch((error)=>{console.log(error);});};restaurants();});